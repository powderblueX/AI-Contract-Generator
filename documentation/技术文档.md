# 合同智能生成系统技术文档

## 一、项目概述
本项目旨在实现合同的智能推荐与自动生成，结合了RAG（检索增强生成）、嵌入模型、向量检索、PyQt前端、FAISS索引、合同模板管理等多项技术，实现了高效、智能、可扩展的合同生成与管理。

## 二、核心技术说明

### 1. RAG（检索增强生成）
- **原理**：RAG（Retrieval-Augmented Generation）结合了检索与生成，先通过向量检索找到最相关的合同模板，再结合用户输入进行智能分析与内容填充。
- **实现**：本项目通过 SentenceTransformer 嵌入模型将合同模板和用户需求转为向量，利用 FAISS 进行高效相似度检索，推荐最合适的合同模板。
- **优势**：提升了推荐的准确性和多样性，避免了单纯生成模型的幻觉问题。
- **选择理由**：RAG 能兼顾知识覆盖与生成灵活性，适合合同等结构化、强约束场景。

### 2. 嵌入模型与向量检索
- **模型**：采用 HuggingFace 的 all-MiniLM-L6-v2 作为嵌入模型，将文本转为高维向量。
- **检索**：利用 FAISS 构建合同模板的向量索引，实现毫秒级的相似度检索。
- **作用**：保证了推荐的高效性和可扩展性。
- **未来优化角度**：可替换为更大参数量、更适合中文的嵌入模型，提升语义理解能力。（此处选择 all-MiniLM-L6-v2 是因为受限于先前竞赛期间的云服务器性能）

### 3. 合同推荐与生成流程
- **推荐**：用户输入需求后，系统先用嵌入模型分析需求，检索最相关的合同模板，结合合同类型、特征等多维度打分，输出推荐列表。
- **生成**：用户选择模板后，系统自动提取需求中的关键信息，智能填充到合同模板的占位符，生成定制化合同文档。
- **技术细节**：
  - 关键词提取、需求分析、模板匹配、占位符填充均有独立模块，便于维护和扩展。
  - 支持多种合同类型和模板，模板管理灵活。
- **未来优化角度**：
  - 合同推荐部分中，合同的关键词描述尤为重要，需要更详细、更全面、更准确的描述。
  - 优化关键词提取模型，比如选用更专业的合同分析模型。同时完善 prompt 设计，提升生成质量。
  - 引入合同分类机制，根据用户输入的内容自动推荐相关分类的合同模板。
  - 优化合同生成模型，如选用更强大的文本生成模型。同时完善 prompt 设计，提升生成质量。

### 4. PyQt 前端界面
- **功能**：提供合同类型选择、模板选择、需求输入、推荐与生成按钮、进度条、日志、结果表格等完整交互。
- **优势**：界面友好，易于操作，适合实际业务场景。
- **选择理由**：PyQt 支持复杂桌面应用开发，跨平台，易于集成。（此处使用 PyQt 仅作为提供前端界面 demo 的方式）

### 5. FAISS 索引与知识库管理
- **作用**：为每类合同模板建立独立的向量索引，支持大规模检索。
- **优势**：高效、可扩展，便于后续模板扩充。
- **未来优化角度**：可结合 ANN 算法、分布式索引等进一步提升性能。

### 6. 合同模板与占位符管理
- **模板**：所有合同模板均为标准 docx 文件，配套 JSON 占位符定义，便于自动化填充。
- **管理**：支持多级分类、批量导入、模板扩展。
- **未来优化角度**：
  - 合同占位符管理：占位符在智能填写合同时十分重要，难以通过大模型直接完善占位符的内容和位置，需要人为设计、人为替换初始文档所需填充的位置。此工作量极大，且需注意合同的更新问题。（目前只进行了《保管合同》的人为完整填写，后续需根据合同更新完善占位符的内容和位置。）

### 7. 大模型与API调用
- **用途**：部分信息抽取、智能分析可调用大模型。
- **选择理由**：提升复杂语义理解与生成能力。
- **未来优化角度**：可根据业务需求切换更强大或更经济的API。同时，可以考虑 AI Agent 与 MCP。

## 三、模型特点与优化建议
- **当前模型**：all-MiniLM-L6-v2，体积小、速度快、适合通用语义检索。
- **未来优化角度**：
  - 针对合同领域微调嵌入模型。
  - 多模型融合，提升复杂场景下的推荐与生成效果。
  - 引入知识图谱、规则引擎辅助。

## 四、架构优势与未来扩展
- **模块化设计**，便于维护和功能扩展。
- **支持多种合同类型和模板，易于扩展新业务。**
- **可对接Web、API、批量处理等多种应用场景。**
- **支持模型和索引的热更新。**

## 五、总结
本项目通过RAG、嵌入检索、智能推荐与生成、模板自动化等多项技术，实现了高效、智能、可扩展的合同生成系统。后续可根据业务需求持续优化模型、算法和系统架构。
